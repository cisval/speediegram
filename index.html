<!doctype html>
<html>
  <script>
  var o = '*';
  var g = window.location.search.substr(1).split('&');

  // If get parameters exsist assume it's an auth response
  if(g.length){
    for(var i=0;g.length>i;i++){
    var p = g[i].split('=');
    if(p[0]==="widget"){
      o = p[1];
      }
    }
  
    var token = window.location.hash.substr(1).split('=');
    if(token[0]==="access_token"){
      sessionStorage.token = token[1];
      window.close();
    }
  }

  function checkForToken(){
    if(sessionStorage.token){
      window.parent.postMessage(sessionStorage.token, "*"); 
      clearInterval(watch);
    }
  }
  var watch = setInterval(checkForToken,500);
  </script>
</html>